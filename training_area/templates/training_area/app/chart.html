{% extends 'navbar.html' %}

<script>
{% block jquery %}
var endpoint = 'api/chartdata'
var defaultData = []
var labels = []
$.ajax({
	method:"GET",
	url: endpoint,
	success: function(data){
		labels = data.labels
		defaultData = data.default
		setChart()
	},
	error: function(error_data){
		console.log("error")
		console.log(error_data)
	}
})

function setChart(){
	var ctx = document.getElementById('myChart');
		var myChart = new Chart(ctx, {
    		type: 'line',
    		data: {
        		labels: labels,
        		datasets: [{
            		label: '# votes',
            		data: defaultData,
				},{
					label: "title2",
        backgroundColor: "transparent",
        borderColor: "#fff",
        data: [50, 50, 50, 50, 50]
				}]
			}
		})
}

$("#id_athlete").change(function(){
	var url = $("#analyticsForm").attr("all-lifts-url");
	var athleteId = $(this).val();

	$.ajax({
		url: url,
		data:{
			'athlete': athleteId
		},
		success: function(data){
			console.log(data)
			$("#id_lifts").html(data);
		}
	});

});


{% endblock %}
</script>

{% block content %}

<div class = 'row'>
	<div class = 'col-sm-12'>
		<h1>Hello</h1>
		<canvas id="myChart" width="400" height="400"></canvas>
	</div>
	{{request.user.coach.coach.all}}
	<form id = "analyticsForm" action="{% url 'app:testdata' %}" method="post" all-lifts-url="{% url 'app:ajax_load_lifts' %}">
		{% csrf_token %}
		<div class="control">
  		<div class="select">

		    <select name = "athlete" id="id_athlete">
		      <option>Select dropdown</option>
		      {% for athlete in request.user.coach.coach.all%}
		      	<option>{{athlete.user.username}}</option>
		      {% endfor %}
		    </select>
		  </div>
		  <div class="select">

		    <select name = "lifts" id="id_lifts">
		      <option>Select dropdown</option>
		    </select>
		  </div>
		</div>
		<!--select microcycle-->
		  <button class = 'button is-small is-link' type="submit">
            <i class="fas fa-divide" type="submit"></i>
           </button>
      </form>
</div>


{% endblock content %}